#!/bin/bash
RESTORE=0
KEEP=0
function showhelp {
	echo "theme help		| displays this"
	echo "theme list		| lists all the themes"
	echo "theme set [theme]	| sets the theme"
	echo "theme keep [theme]	| sets the theme as default theme, note: this does not apply it"
	echo "theme restore		| restores the default theme"
	echo "theme get		| outputs the default theme"
	return
}
function settheme {
	if [ ! $1 ]; then
		showhelp
		exit
	fi
	export DESKTOP_THEME=$1
	if [ ! -d "$HOME/.config/tim241/themes/$DESKTOP_THEME" ]; then
		echo "==> Invalid theme selected"
		showhelp
		exit
	fi
	echo "==> Setting gtk theme"
	$HOME/.config/tim241/bin/gtk
	echo "==> Setting Xdefaults theme"
	$HOME/.config/tim241/bin/lxdef
	echo "==> Setting wallpaper"
	$HOME/.config/tim241/bin/wallpaper
	echo "==> Completed"
}
case $1 in 
	help) showhelp; exit;;
	list) ls $HOME/.config/tim241/themes/ -1; exit;;
	set) settheme $2; exit;;
	keep) 
		if [ ! $2 ]; then
			showhelp
			exit
		fi
		if [ ! -d "$HOME/.config/tim241/themes/$2" ]; then
               		echo "==> Invalid theme selected"
       		        showhelp
	                exit
	        fi
		if [ ! -d "$HOME/.cache/theme" ]; then
               	        mkdir -p $HOME/.cache/theme
                fi
                echo $2 > $HOME/.cache/theme/name
		exit
		;;
	restore) 
		if [ -f $HOME/.cache/theme/name ]; then
               	        settheme $(cat $HOME/.cache/theme/name)
               	else
               	        echo No previous theme applied.
               	       	exit 
               	fi
		exit
		;;
	get)
		if [ -f $HOME/.cache/theme/name ]; then
			echo $(cat $HOME/.cache/theme/name)
		else
			echo simple_dark
		fi
		exit
		;;
	*) showhelp; exit;;
esac
